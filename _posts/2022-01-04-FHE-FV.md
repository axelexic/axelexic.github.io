---
layout: post
title: Fan-Vercauteren
date: 2022-01-04
---

### RLWE Based Encryption Scheme

> Definition:
>
> For security parameter $\lambda$, let $f(x)$ be the cyclotomic polynomial $\Phi_m(x)$ with $\text{deg}(f) = \phi(m)$ dependent on the security paramter $\lambda$ and set $R = \mathbb{Z}[x]/\langle f(x) \rangle$. Let $R_q$ be the ring $R/qR $  $\cong Z[x]/\langle f(x), q \rangle$ $\cong Z_p[x]/\langle \bar{f}(x)\rangle$  where $\bar{f} = f \mod q$. For a random $\mathbf{s} \in R_q$ and a distribution $\chi = \chi(\lambda)$ over $R$, denote by $\mathcal{A}_{\mathbf{s},\chi}^{(q)}$ the distribution obtained by choosing a uniformly random $\mathbf{a} \leftarrow R$   and a noise term $\mathbf{e} \leftarrow \chi $ and outputting $(\mathbf{a}, [\mathbf{a}\mathbf{s} + e]_q)$. The decisional Ring-LWE problems asks one to distinguish $(\mathbf{a}, [\mathbf{a}\mathbf{s} + e]_q)$ from purely random data.

##### Encryption Scheme

- KeyGen:

  - Sample $\mathbf{s} \leftarrow \chi$ and output $\mathtt{sk} := \mathbf{s}$ as the secret key.

  - Sample uniformly $\mathbf{a} \leftarrow R_q$, $\mathbf{e} \leftarrow \chi$ and output 
    $$
    \mathtt{pk} := (\mathbf{p}_0,\mathbf{p}_1) := (-[\mathbf{a}\cdot\mathbf{s} + \mathbf{e}]_q, \mathbf{a}) \in R_q\times R_q
    \label{eq:basic-pk-gen}
    $$
    Note that $\mathbf{s}$ and $\mathbf{e}$ are both elements of $R$ and $\mathbf{p}_0 + \mathbf{s}\cdot\mathbf{p}_1 \approx 0$.  

- Encrypt: Let $\mathtt{pt}$ be the plaintext message. Encode $\mathtt{pt}$ as a polynomial $\mathbf{m} \in R/tR$ where $t$ is a suitable integer dependent on $q$. To encrypt $\mathbf{m}$ 

  - Sample $\mathbf{u} \leftarrow \chi$

  - Sample $\mathbf{e}_1 \leftarrow \chi$

  - Sample $\mathbf{e}_2 \leftarrow \chi$

  - Compute ciphertext by 

    - First blind $\mathbf{u}$ by computing 
      $$
      \mathbf{c}_0 := [\mathbf{p}_1\cdot \mathbf{u} + \mathbf{e}_1]_q = [\mathbf{a}\cdot \mathbf{u} + \mathbf{e}_1]_q \in R_q
      $$

    - Then blind the message $\mathbf{m}$ by computing 
      $$
      \mathbf{c}_1 := \left[\mathbf{p}_0\cdot \mathbf{u} + \mathbf{e}_1 + \lfloor \frac{q}{t}\rfloor\mathbf{m}\right]_q = \left[(-[\mathbf{a}\cdot\mathbf{s} + \mathbf{e}]_q)\cdot \mathbf{u} + \mathbf{e}_1 + \lfloor \frac{q}{t}\rfloor\mathbf{m}\right]_q \in R_q
      $$
      and output ciphertext as $\mathtt{ct} = (\mathbf{c}_0, \mathbf{c}_1) \in R_q \times R_q$.
  
- Decryption: To decrypt, one only needs to observe that $\mathbf{c}_0\cdot \mathbf{s} + \mathbf{c}_1$ cancels $\mathbf{a}\cdot\mathbf{s}\cdot\mathbf{u}$ term and what is left is $\left [-\mathbf{e}\cdot\mathbf{u} + \mathbf{e}_1 + \lfloor \frac{q}{t}\rfloor\mathbf{m}\right ]_q$. Therefore, to recover $\mathbf{m}$, compute 
  $$
  \mathbf{m} = \left[\left \lfloor \frac{t(\mathbf{c}_0\cdot \mathbf{s} + \mathbf{c}_1)}{q} \right \rceil \right]_q
  $$

- 

> **Example**: Basic encryption decryption
>
> Support we choose $\Phi_m(x)$ to be the $16$-th cyclotomic polynomial $x^8+1$. Let $q=2^{10} = 1024$ and $t = 256$. Let $\chi$ be the discrete gaussian distribution with mean $0$ and variance $16 \ll 1024$. We will use the following setup in SageMath to compute this
>
> ```python
> from sage.stats.distributions.discrete_gaussian_polynomial import DiscreteGaussianDistributionPolynomialSampler
> from sage.all import *
> 
> cyclo_degree = 16
> R.<h> = NumberField(cyclotomic_polynomial(cyclo_degree))
> q = 1024
> t = q // 4 # 256
> sigma = 16 
> 
> 
> 
> ```
>
>  